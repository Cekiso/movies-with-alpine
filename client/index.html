<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <title>CineVerse - Your Movie Universe</title>
     <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>


</head>

<body>
    <div id="app"></div>
    <div x-data="enterOpen" class="enterOpen">

        <div class="row">
            <div class="col-12">
                <div x-show="logUser" class="container">
                    <div class="row">
                        <div class="col-12">
                            <h1>Login</h1>
                            <p>Please login in your username and password</p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            <div x-text="loginSuccessMsg" style="color:green ;"></div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-6">
                            <label class="form-label">
                                <b>Username</b>
                            </label>
                            <input type="text" class="form-control" x-model="username" />
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6">
                            <label class="form-label">
                                <b>Password</b>
                            </label>
                            <input type="password" class="form-control" x-model="password" />
                        </div>
                    </div>
                    <br>
                    <div class="row">
                        <div class="col-12">
                            <button class="btn btn-primary" @click="logUser=true, logIn()">
                                Login
                            </button>
                        </div>
                    </div>
                    <div class="row">
                        <p class="col-12">
                            Don't have an account?

                            <a href="#" @click="createAcc = true, logUser = false">Create Account</a>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div x-show="createAcc" class="container">

                <div class="col-12">
                    <h1>Sign up</h1>
                    <p>Please fill in this form to create an account</p>
                </div>

                <div class="row">
                    <div class="col-12">
                        <div x-text="registerSuccessMsg" class="text-success" style="color: green;"></div>
                    </div>
                </div>

                <div class="col-6">
                    <label class="form-label" for="first_name">
                        <b>Firstname</b>
                    </label>
                    <input class="form-control" type="text" id="first_name" x-model="firstname" name="firstname"
                        required />
                </div>

                <div class="col-6">
                    <label class="form-label" for="lastname">
                        <b>Lastname</b>
                    </label>
                    <input class="form-control" type="text" x-model="lastname" name="lastname" id="lastname" />
                </div>


                <div class="col-6">
                    <label class="form-label" for="username">
                        <b>Username</b>
                    </label>
                    <input type="text" x-model="usernameReg" name="username" class="velidate; form-control"
                        id="username" required />
                </div>

                <div class="col-6">
                    <label class="form-label" for="password">
                        <b>Password</b>
                    </label>
                    <input type="password" class="form-control" id="password" x-model="passwordReg" name="password"
                        required />
                </div>

                <div class="col-12">
                    <p>
                        By creating an account you agree to our
                        <a href="#" style="color: dodgerblue">Terms & Privacy</a>.
                    </p>
                </div>

                <div class="col-12">
                    <button class="btn btn-primary" @click="logUser=false, createAcc=true, register()">
                        Signup
                    </button>
                </div>
                <div class="col-12">
                    <p>
                        Login here if you have registered

                        <a href="#" @click="logUser= true, createAcc= false">Login</a>
                    </p>
                </div>
            </div>
        </div>


        <header class="header">
            <div class="header-content">
                <div class="logo" x-show="nav">üé¨ CineVerse</div>
                <div class="nav-buttons" x-show="nav">
                    <button class="btn btn-secondary"
                        :class="{'active': displayMovies && !displayResults && !favoriteMovies}"
                        @click="displayResults=false; displayMovies=true; favoriteMovies=false; playlist()">
                        Browse
                    </button>
                    <button class="btn btn-secondary" :class="{'active': displayResults}"
                        @click="displayMovies=false; favoriteMovies=false; displayResults=true">
                        Search
                    </button>
                    <button class="btn btn-secondary" :class="{'active': favoriteMovies}"
                        @click="displayResults=false; displayMovies=false; favoriteMovies=true; Addplaylist()">
                        My Library (<span x-text="favPlaylists ? favPlaylists.length : 0"></span>)
                    </button>
                    <button class="btn btn-primary"
                        @click="logUser=true; displayMovies=false; favoriteMovies=false; nav=false; displayResults=false; logOut()">
                        Logout
                    </button>
                </div>
            </div>
        </header>

        <!-- Hero Section -->
        <section class="hero" x-show="displayMovies && !displayResults && !favoriteMovies">
            <div class="hero-content">
                <h1>Discover Your Next Favorite Movie</h1>
                <p>Explore thousands of movies with our innovative browsing experience</p>
                <button class="btn btn-primary" style="font-size: 1.1rem; padding: 0.8rem 2rem;"
                    @click="displayResults=true; displayMovies=false">
                    Start Exploring
                </button>
            </div>
        </section>

        <!-- Search Section -->
        <div class="search-section" x-show="displayResults">
            <div class="search-box">
                <h2 class="search-title">üîç Search for Movies</h2>
                <div class="search-input-group">
                    <input type="text" x-model="movie_name" placeholder="Search by title, people, or genres..."
                        class="search-input" @keyup.enter="playlist()">
                    <button class="search-btn" @click="playlist()">
                        <i class="fa fa-search"></i> Search
                    </button>
                </div>
                <div x-show="noMovies" class="no-movies-msg">
                    <i class="fa fa-exclamation-circle"></i>
                    <span x-text="noMovies"></span>
                </div>
            </div>
        </div>

        <!-- Movies Grid -->
        <div x-show="displayMovies || displayResults">
            <div class="movies-grid">
                <template x-for="movie in movies" :key="movie.id">
                    <div class="movie-card">
                        <img :src="`https://image.tmdb.org/t/p/w500${movie.poster_path}`" :alt="movie.title"
                            class="movie-poster" onerror="this.src='https://via.placeholder.com/250x350?text=No+Image'">
                        <div class="movie-info">
                            <div class="movie-title" x-text="movie.title"></div>
                            <div class="movie-meta">
                                <span x-text="movie.release_date"></span>
                                <span class="rating" x-show="movie.vote_average">
                                    ‚≠ê <span x-text="movie.vote_average ? movie.vote_average.toFixed(1) : 'N/A'"></span>
                                </span>
                            </div>
                            <button class="save-btn" :class="isSaved(movie.id) && 'saved'"
                                @click="original_title=movie.title; movie_id=movie.id; poster_img=movie.poster_path; favouriteMovie()">
                                <i class="fas fa-plus-circle"></i>
                                <span x-text="isSaved(movie.id) ? '‚úì Saved' : 'Add to Library'"></span>
                                 Add to List
                            </button>
                        </div>
                    </div>
                </template>
            </div>
        </div>

        <!-- My Library -->
        <div x-show="favoriteMovies">
            <div class="library-header">
                <h1 class="library-title">üìö My Movie Library</h1>
            </div>

            <template x-if="!favPlaylists || favPlaylists.length === 0">
                <div class="empty-state">
                    <div class="empty-state-icon">üé¨</div>
                    <h2>Your library is empty</h2>
                    <p style="margin-top: 1rem;">Start adding movies to build your collection!</p>
                    <button class="btn btn-primary" style="margin-top: 2rem;"
                        @click="displayResults=true; favoriteMovies=false">
                        Browse Movies
                    </button>
                </div>
            </template>

            <template x-if="favPlaylists && favPlaylists.length > 0">
                <div class="movies-grid">
                    <template x-for="movie in favPlaylists" :key="movie.movie_id">
                        <div class="movie-card">
                            <img :src="`https://image.tmdb.org/t/p/w500${movie.img}`" :alt="movie.movie_title"
                                class="movie-poster"
                                onerror="this.src='https://via.placeholder.com/250x350?text=No+Image'">
                            <div class="movie-info">
                                <div class="movie-title" x-text="movie.movie_title"></div>
                                <button class="save-btn saved" @click="deleteMovie(movie)">
                                    ‚úì Remove from Library
                                </button>
                            </div>
                        </div>
                    </template>
                </div>
            </template>

        <!-- Success Toast -->
        <div x-show="addedList" class="success-toast" x-text="addedList"></div>


        <!-- <script type="module" src="/main.js"></script> -->
         <!-- <script type="module" src="/src/main.js"></script> -->
         <script type="module">
        import moviesApp from './moviesApp.js';
        window.moviesApp = moviesApp;
    </script>
</div>
</div>
</body>

</html>